[2022-05-26 09:37:24,335][src.params.main_params][INFO] - Load config: {'output_path': 'outputs/seq2seq_bidirectional/', 'tensorboard_logdir': 'outputs/seq2seq_bidirectional//tensorboard_logdir', 'log_dir': 'outputs/seq2seq_bidirectional/', 'debug': False, 'dataset': {'dataset_path': '../../data/data.txt', 'dataset_url': 'https://raw.githubusercontent.com/neychev/made_nlp_course/master/datasets/Machine_translation_EN_RU/data.txt', 'source_language': 'ru', 'target_language': 'en', 'source_language_index': 1, 'target_language_index': 0, 'train_dataset_path': '../../data/train_data.txt', 'val_dataset_path': '../../data/val_data.txt', 'test_dataset_path': '../../data/test_data.txt', 'train_size': 0.8, 'val_size': 0.15, 'test_size': 0.05}, 'model': {'enc_emb_dim': 128, 'dec_emb_dim': 128, 'enc_hid_dim': 256, 'dec_hid_dim': 256, 'attn_dim': 128, 'enc_dropout': 0.5, 'dec_dropout': 0.5, 'pretrained_embedding': 'fasttext', 'rnn_type': 'lstm', 'bidirectional': True}, 'train': {'batch_size': 16, 'n_epoch': 40, 'device': 'cuda', 'learning_rate': 0.0008}, 'preprocessing': {'spacy_tokenizer': {'ru': 'ru_core_news_sm', 'en': 'en_core_web_sm'}}}
[2022-05-26 09:37:24,336][src.data.dataset][INFO] - Loading dataset
[2022-05-26 09:37:24,476][src.data.dataset][INFO] - Split data into: (39999, 7499, 2501)
[2022-05-26 09:37:24,774][src.data.dataset][INFO] - Split dataset.
[2022-05-26 09:37:27,094][pymorphy2.opencorpora_dict.wrapper][INFO] - Loading dictionaries from /home/juliarty/Documents/WorkArea/MADE/nlp/translation/venv/lib/python3.8/site-packages/pymorphy2_dicts_ru/data
[2022-05-26 09:37:27,176][pymorphy2.opencorpora_dict.wrapper][INFO] - format: 2.4, revision: 417127, updated: 2020-10-11T15:05:51.070345
[2022-05-26 09:38:11,482][__main__][INFO] - The model has 16,270,939 trainable parameters
[2022-05-26 09:38:11,482][__main__][INFO] - Start training.
[2022-05-26 09:42:49,924][src.train][INFO] - Epoch: 01 | Time: 4m 38s
[2022-05-26 09:42:49,924][src.train][INFO] - 	Train Loss: 4.206 | Train PPL:  67.075
[2022-05-26 09:42:49,924][src.train][INFO] - 	 Val. Loss: 4.686 |  Val. PPL: 108.371
[2022-05-26 09:47:28,083][src.train][INFO] - Epoch: 02 | Time: 4m 38s
[2022-05-26 09:47:28,084][src.train][INFO] - 	Train Loss: 3.250 | Train PPL:  25.795
[2022-05-26 09:47:28,084][src.train][INFO] - 	 Val. Loss: 4.543 |  Val. PPL:  94.014
[2022-05-26 09:51:52,429][src.train][INFO] - Epoch: 03 | Time: 4m 24s
[2022-05-26 09:51:52,429][src.train][INFO] - 	Train Loss: 2.841 | Train PPL:  17.128
[2022-05-26 09:51:52,429][src.train][INFO] - 	 Val. Loss: 4.533 |  Val. PPL:  93.048
[2022-05-26 09:56:16,681][src.train][INFO] - Epoch: 04 | Time: 4m 24s
[2022-05-26 09:56:16,681][src.train][INFO] - 	Train Loss: 2.577 | Train PPL:  13.164
[2022-05-26 09:56:16,681][src.train][INFO] - 	 Val. Loss: 4.527 |  Val. PPL:  92.473
[2022-05-26 10:00:35,059][src.train][INFO] - Epoch: 05 | Time: 4m 18s
[2022-05-26 10:00:35,059][src.train][INFO] - 	Train Loss: 2.377 | Train PPL:  10.769
[2022-05-26 10:00:35,059][src.train][INFO] - 	 Val. Loss: 4.584 |  Val. PPL:  97.857
[2022-05-26 10:04:58,936][src.train][INFO] - Epoch: 06 | Time: 4m 23s
[2022-05-26 10:04:58,936][src.train][INFO] - 	Train Loss: 2.203 | Train PPL:   9.054
[2022-05-26 10:04:58,936][src.train][INFO] - 	 Val. Loss: 4.654 |  Val. PPL: 104.982
[2022-05-26 10:09:18,125][src.train][INFO] - Epoch: 07 | Time: 4m 19s
[2022-05-26 10:09:18,125][src.train][INFO] - 	Train Loss: 2.083 | Train PPL:   8.032
[2022-05-26 10:09:18,125][src.train][INFO] - 	 Val. Loss: 4.628 |  Val. PPL: 102.259
[2022-05-26 10:13:40,349][src.train][INFO] - Epoch: 08 | Time: 4m 22s
[2022-05-26 10:13:40,349][src.train][INFO] - 	Train Loss: 1.978 | Train PPL:   7.229
[2022-05-26 10:13:40,349][src.train][INFO] - 	 Val. Loss: 4.708 |  Val. PPL: 110.802
[2022-05-26 10:18:00,257][src.train][INFO] - Epoch: 09 | Time: 4m 19s
[2022-05-26 10:18:00,257][src.train][INFO] - 	Train Loss: 1.894 | Train PPL:   6.644
[2022-05-26 10:18:00,257][src.train][INFO] - 	 Val. Loss: 4.740 |  Val. PPL: 114.403
[2022-05-26 10:22:18,881][src.train][INFO] - Epoch: 10 | Time: 4m 18s
[2022-05-26 10:22:18,881][src.train][INFO] - 	Train Loss: 1.816 | Train PPL:   6.146
[2022-05-26 10:22:18,881][src.train][INFO] - 	 Val. Loss: 4.806 |  Val. PPL: 122.282
[2022-05-26 10:26:41,048][src.train][INFO] - Epoch: 11 | Time: 4m 22s
[2022-05-26 10:26:41,048][src.train][INFO] - 	Train Loss: 1.755 | Train PPL:   5.781
[2022-05-26 10:26:41,048][src.train][INFO] - 	 Val. Loss: 4.832 |  Val. PPL: 125.434
[2022-05-26 10:30:59,492][src.train][INFO] - Epoch: 12 | Time: 4m 18s
[2022-05-26 10:30:59,492][src.train][INFO] - 	Train Loss: 1.680 | Train PPL:   5.366
[2022-05-26 10:30:59,492][src.train][INFO] - 	 Val. Loss: 4.873 |  Val. PPL: 130.748
[2022-05-26 10:35:22,553][src.train][INFO] - Epoch: 13 | Time: 4m 23s
[2022-05-26 10:35:22,553][src.train][INFO] - 	Train Loss: 1.633 | Train PPL:   5.119
[2022-05-26 10:35:22,553][src.train][INFO] - 	 Val. Loss: 4.972 |  Val. PPL: 144.266
[2022-05-26 10:39:40,466][src.train][INFO] - Epoch: 14 | Time: 4m 17s
[2022-05-26 10:39:40,466][src.train][INFO] - 	Train Loss: 1.592 | Train PPL:   4.915
[2022-05-26 10:39:40,466][src.train][INFO] - 	 Val. Loss: 4.979 |  Val. PPL: 145.374
[2022-05-26 10:44:02,347][src.train][INFO] - Epoch: 15 | Time: 4m 21s
[2022-05-26 10:44:02,347][src.train][INFO] - 	Train Loss: 1.548 | Train PPL:   4.702
[2022-05-26 10:44:02,347][src.train][INFO] - 	 Val. Loss: 5.020 |  Val. PPL: 151.470
[2022-05-26 10:48:21,903][src.train][INFO] - Epoch: 16 | Time: 4m 19s
[2022-05-26 10:48:21,903][src.train][INFO] - 	Train Loss: 1.512 | Train PPL:   4.535
[2022-05-26 10:48:21,903][src.train][INFO] - 	 Val. Loss: 5.050 |  Val. PPL: 156.068
[2022-05-26 10:52:41,346][src.train][INFO] - Epoch: 17 | Time: 4m 19s
[2022-05-26 10:52:41,346][src.train][INFO] - 	Train Loss: 1.479 | Train PPL:   4.387
[2022-05-26 10:52:41,346][src.train][INFO] - 	 Val. Loss: 5.108 |  Val. PPL: 165.319
[2022-05-26 10:57:03,130][src.train][INFO] - Epoch: 18 | Time: 4m 21s
[2022-05-26 10:57:03,130][src.train][INFO] - 	Train Loss: 1.426 | Train PPL:   4.160
[2022-05-26 10:57:03,130][src.train][INFO] - 	 Val. Loss: 5.191 |  Val. PPL: 179.676
[2022-05-26 11:01:21,392][src.train][INFO] - Epoch: 19 | Time: 4m 18s
[2022-05-26 11:01:21,392][src.train][INFO] - 	Train Loss: 1.409 | Train PPL:   4.092
[2022-05-26 11:01:21,392][src.train][INFO] - 	 Val. Loss: 5.210 |  Val. PPL: 183.102
[2022-05-26 11:05:44,329][src.train][INFO] - Epoch: 20 | Time: 4m 22s
[2022-05-26 11:05:44,330][src.train][INFO] - 	Train Loss: 1.375 | Train PPL:   3.954
[2022-05-26 11:05:44,330][src.train][INFO] - 	 Val. Loss: 5.237 |  Val. PPL: 188.159
[2022-05-26 11:10:02,393][src.train][INFO] - Epoch: 21 | Time: 4m 18s
[2022-05-26 11:10:02,393][src.train][INFO] - 	Train Loss: 1.352 | Train PPL:   3.866
[2022-05-26 11:10:02,393][src.train][INFO] - 	 Val. Loss: 5.303 |  Val. PPL: 200.873
[2022-05-26 11:14:24,880][src.train][INFO] - Epoch: 22 | Time: 4m 22s
[2022-05-26 11:14:24,880][src.train][INFO] - 	Train Loss: 1.319 | Train PPL:   3.741
[2022-05-26 11:14:24,880][src.train][INFO] - 	 Val. Loss: 5.312 |  Val. PPL: 202.711
[2022-05-26 11:18:44,940][src.train][INFO] - Epoch: 23 | Time: 4m 20s
[2022-05-26 11:18:44,940][src.train][INFO] - 	Train Loss: 1.290 | Train PPL:   3.634
[2022-05-26 11:18:44,940][src.train][INFO] - 	 Val. Loss: 5.377 |  Val. PPL: 216.331
[2022-05-26 11:23:04,390][src.train][INFO] - Epoch: 24 | Time: 4m 19s
[2022-05-26 11:23:04,391][src.train][INFO] - 	Train Loss: 1.275 | Train PPL:   3.579
[2022-05-26 11:23:04,391][src.train][INFO] - 	 Val. Loss: 5.421 |  Val. PPL: 226.146
[2022-05-26 11:27:26,526][src.train][INFO] - Epoch: 25 | Time: 4m 22s
[2022-05-26 11:27:26,527][src.train][INFO] - 	Train Loss: 1.240 | Train PPL:   3.454
[2022-05-26 11:27:26,527][src.train][INFO] - 	 Val. Loss: 5.463 |  Val. PPL: 235.826
[2022-05-26 11:31:44,968][src.train][INFO] - Epoch: 26 | Time: 4m 18s
[2022-05-26 11:31:44,968][src.train][INFO] - 	Train Loss: 1.230 | Train PPL:   3.422
[2022-05-26 11:31:44,968][src.train][INFO] - 	 Val. Loss: 5.464 |  Val. PPL: 235.990
[2022-05-26 11:36:08,186][src.train][INFO] - Epoch: 27 | Time: 4m 23s
[2022-05-26 11:36:08,186][src.train][INFO] - 	Train Loss: 1.212 | Train PPL:   3.360
[2022-05-26 11:36:08,186][src.train][INFO] - 	 Val. Loss: 5.485 |  Val. PPL: 241.134
[2022-05-26 11:40:27,285][src.train][INFO] - Epoch: 28 | Time: 4m 19s
[2022-05-26 11:40:27,285][src.train][INFO] - 	Train Loss: 1.186 | Train PPL:   3.274
[2022-05-26 11:40:27,285][src.train][INFO] - 	 Val. Loss: 5.592 |  Val. PPL: 268.384
[2022-05-26 11:44:50,205][src.train][INFO] - Epoch: 29 | Time: 4m 22s
[2022-05-26 11:44:50,205][src.train][INFO] - 	Train Loss: 1.176 | Train PPL:   3.241
[2022-05-26 11:44:50,205][src.train][INFO] - 	 Val. Loss: 5.579 |  Val. PPL: 264.726
[2022-05-26 11:49:09,307][src.train][INFO] - Epoch: 30 | Time: 4m 19s
[2022-05-26 11:49:09,307][src.train][INFO] - 	Train Loss: 1.152 | Train PPL:   3.164
[2022-05-26 11:49:09,307][src.train][INFO] - 	 Val. Loss: 5.614 |  Val. PPL: 274.368
[2022-05-26 11:53:30,542][src.train][INFO] - Epoch: 31 | Time: 4m 21s
[2022-05-26 11:53:30,542][src.train][INFO] - 	Train Loss: 1.150 | Train PPL:   3.159
[2022-05-26 11:53:30,542][src.train][INFO] - 	 Val. Loss: 5.594 |  Val. PPL: 268.783
[2022-05-26 11:57:52,204][src.train][INFO] - Epoch: 32 | Time: 4m 21s
[2022-05-26 11:57:52,204][src.train][INFO] - 	Train Loss: 1.120 | Train PPL:   3.066
[2022-05-26 11:57:52,204][src.train][INFO] - 	 Val. Loss: 5.679 |  Val. PPL: 292.536
[2022-05-26 12:02:11,604][src.train][INFO] - Epoch: 33 | Time: 4m 19s
[2022-05-26 12:02:11,604][src.train][INFO] - 	Train Loss: 1.102 | Train PPL:   3.009
[2022-05-26 12:02:11,604][src.train][INFO] - 	 Val. Loss: 5.685 |  Val. PPL: 294.549
[2022-05-26 12:06:34,742][src.train][INFO] - Epoch: 34 | Time: 4m 23s
[2022-05-26 12:06:34,742][src.train][INFO] - 	Train Loss: 1.094 | Train PPL:   2.986
[2022-05-26 12:06:34,742][src.train][INFO] - 	 Val. Loss: 5.758 |  Val. PPL: 316.761
[2022-05-26 12:10:53,870][src.train][INFO] - Epoch: 35 | Time: 4m 19s
[2022-05-26 12:10:53,870][src.train][INFO] - 	Train Loss: 1.080 | Train PPL:   2.943
[2022-05-26 12:10:53,870][src.train][INFO] - 	 Val. Loss: 5.722 |  Val. PPL: 305.479
[2022-05-26 12:15:17,119][src.train][INFO] - Epoch: 36 | Time: 4m 23s
[2022-05-26 12:15:17,119][src.train][INFO] - 	Train Loss: 1.061 | Train PPL:   2.888
[2022-05-26 12:15:17,119][src.train][INFO] - 	 Val. Loss: 5.814 |  Val. PPL: 334.962
[2022-05-26 12:19:35,781][src.train][INFO] - Epoch: 37 | Time: 4m 18s
[2022-05-26 12:19:35,781][src.train][INFO] - 	Train Loss: 1.041 | Train PPL:   2.833
[2022-05-26 12:19:35,781][src.train][INFO] - 	 Val. Loss: 5.833 |  Val. PPL: 341.377
[2022-05-26 12:23:57,109][src.train][INFO] - Epoch: 38 | Time: 4m 21s
[2022-05-26 12:23:57,109][src.train][INFO] - 	Train Loss: 1.039 | Train PPL:   2.828
[2022-05-26 12:23:57,109][src.train][INFO] - 	 Val. Loss: 5.855 |  Val. PPL: 349.086
[2022-05-26 12:28:17,211][src.train][INFO] - Epoch: 39 | Time: 4m 20s
[2022-05-26 12:28:17,211][src.train][INFO] - 	Train Loss: 1.018 | Train PPL:   2.767
[2022-05-26 12:28:17,211][src.train][INFO] - 	 Val. Loss: 5.890 |  Val. PPL: 361.430
[2022-05-26 12:32:36,689][src.train][INFO] - Epoch: 40 | Time: 4m 19s
[2022-05-26 12:32:36,689][src.train][INFO] - 	Train Loss: 1.011 | Train PPL:   2.747
[2022-05-26 12:32:36,689][src.train][INFO] - 	 Val. Loss: 5.912 |  Val. PPL: 369.477
[2022-05-26 12:36:25,449][__main__][INFO] - BLEU: 30.743813680035633
[2022-05-26 12:36:25,449][__main__][INFO] - Saving results
